<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="HandheldFriendly" content="True">
	<meta name="MobileOptimized" content="320">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta http-equiv="cleartype" content="on">
	<meta name="description" content="OPEN API">
	<meta name="author" content="yub">
	<title>OPEN API</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.css">
	<style>
		table td{
			vertical-align: middle;
			font-size:13px;
		}
		.page-wrapper{
			padding: 0;
			margin: 0;
			min-height: 100vh;
			background: linear-gradient(to top right, #08aeea 0%, #b721ff 100%);
			padding-top: 45px;
			padding-bottom: 50px;
		}
		.wrapper--790{
			padding: 0;
			box-sizing: inherit;
			margin: 0 auto;
			max-width: 790px;
		}
		.card-5{
			padding: 0;
			margin: 0;
			box-sizing: inherit;
			background: #fff;
			border-radius: 10px;
			box-shadow: 0px 8px 20px 0px rgba(0, 0, 0, 0.15);
		}
		.card-heading{
			font-weight: 400;
			font-size: 14px;
			margin: 0;
			box-sizing: inherit;
			padding: 20px 0;
			background: #1a1a1a;
			border-top-left-radius: 10px;
			border-top-right-radius: 10px;
		}
		.title{
			box-sizing: inherit;
			margin: 0;
			padding: 0;
			font-size: 24px;
			font-weight: 700;
			text-align: center;
			color: #fff;
		}
	</style>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
	
	<script type="text/javascript">
		
		$(function(){
			$("#reSendApi").click(function() {
			var type1 = $("#resendType1 option:selected").val();
			var type2 = $("#resendType2 option:selected").val();
			
			if($("#sRsndRqtDate").val() == '') {
				alert("요청일자를 선택하세요.");
				$("#sRsndRqtDate").focus();
				return false;
			}

			$("#rsndRqtFrm").find('input').each(function() {
				$(this).val("");
			});
			
			var frm = document.rsndRqtFrm;
			frm.gpcomId.value = $("#sGpcomId").val();
			frm.rsndRqtDate.value  = $("#sRsndRqtDate").val().replace(/\./g, "");
			
			resendResultList = new Array();
			
			if(type1 == "1") {
				frm.rsndRqtCnt.value = $('#resendType2 option:not([value="ALL"])').length;
				$('#resendType2 option:not([value="ALL"])').each(function() {
					frm.objDivNm.value = $(this).val();
					if("reapperrorEvent" == $(this).val()) {
						ajaxSend("ajaxReAppErrorEvent", $(this).text());
					} else if("remonitoringEvent" == $(this).val()) {
						ajaxSend("ajaxReMonitoringEvent", $(this).text());
					} else {
						ajaxSend("ajaxReSendSumInfo", ($(this).text() + " 누적정보"));
					}
				});
			} else {
				frm.rsndRqtCnt.value = "1";
				frm.objDivNm.value = type2;
				ajaxSend("ajaxReStatisticInfo", "정산 통계정보");
			}
		});
		
		function ajaxSend(rsndUrl, rsndNm) {
			var frm = document.rsndRqtFrm;
			
			$.ajax({
				url : "${pageContext.request.contextPath}/operation/resendMgt/" + rsndUrl
				, type : "POST"
				, dataType : "json"
				, data : $("#rsndRqtFrm").serialize()
				, beforeSend : function() {
					$('.wrap-loading').removeClass('display-none');
				}
				, complete : function() {
					if(frm.rsndRqtCnt.value == resendResultList.length) {
						$('.wrap-loading').addClass('display-none');
						var msg = "재전송 요청 정상 처리되었습니다.";

						if(frm.rsndRqtCnt.value == 1) {
							if("N" == resendResultList[0].succYn) {
								msg = resendResultList[0].msg;
							}
						} else {
							$.each(resendResultList, function(index) {
								msg += "\n - " + resendResultList[index].rsndNm + ("Y" == resendResultList[index].succYn ? " 재전송 요청 성공" : " 재전송 요청 실패");
							});
						}
						alert(msg);
					}
				}
				, success : function(data) {
					var data = {rsndNm : rsndNm, succYn : "0000" == data.resultCode ? "Y" : "N", msg : data.resultMessage};
					resendResultList.push(data);
				}
				, error : function(data) {
					var data = {rsndNm : rsndNm, succYn : "N", msg : "재전송 요청이 실패하였습니다."};
					resendResultList.push(data);
				}
			});
		}
		
		// timestamp 구하기
		function makeoid() {
			var now = new Date();
			var years = now.getFullYear();
			var months = LPad(now.getMonth() + 1, 2, "0");
			var dates = LPad(now.getDate(), 2, "0");
			var hours = LPad(now.getHours(), 2, "0");
			var minutes = LPad(now.getMinutes(), 2, "0");
			var seconds = LPad(now.getSeconds(), 2, "0");
			var timeValue = years + months + dates + hours + minutes + seconds; 
			document.getElementById("LGD_TIMESTAMP").value = timeValue;
		}
		
		function LPad(digit, size, attatch) {
		    var add = "";
		    digit = digit.toString();

		    if (digit.length < size) {
		        var len = size - digit.length;
		        for (i = 0; i < len; i++) {
		            add += attatch;
		        }
		    }
		    return add + digit;
		}
		
		});
	</script>
</head>
<body>
<div class="page-wrapper">
	<div class="wrapper--790">
		<div class="card-5">
			<div class="card-heading">
				<h2 class="title">OPEN API</h2>
			</div>
			<form id="inputForm" name="inputForm" action="" method="post">
				<p>
				<div class="container">
					<table class="table-sm table-bordered table-hover" style="width:100%;">
					<colgroup>
						<col width="30%">
						<col width="80%">
					</colgroup>
					<thead>
					</thead>
					<tbody>
						<tr>
							<td>결제수단</td>
							<td>
								<select class="form-control" id="usablepay" name="usablepay">
									<option value="카드" >신용카드</option>
									<option value="계좌이체" >계좌이체</option>
									<option value="가상계좌" >가상계좌</option>
									<option value="billing" >빌링</option>
								</select>
							</td>
						</tr>
						<tr name="pay_card">
							<td>결제금액</td>
							<td data-toggle="tooltip">
								<label for="mertid" class="sr-only"></label>
								<input type="text" id="amount" name="amount" class="form-control form-control-sm" readonly placeholder="amount" required value="200">
							</td>
						</tr>
						<tr name="pay_card">
							<td>주문번호</td>
							<td data-toggle="tooltip">
								<input type="text" id="orderId" name="orderId" class="form-control" placeholder="orderId" value="">
							</td>
						</tr>
						<tr name="pay_card">
							<td>주문명</td>
							<td data-toggle="tooltip">
								<label for="partnercd" class="sr-only"></label>
								<input type="text" id="orderName" name="orderName" class="form-control" placeholder="orderName" value="전자결제_테스트">
							</td>
						</tr>
						<tr name="pay_card">
							<td>구매자명</td>
							<td data-toggle="tooltip">
								<label for="partnercd" class="sr-only"></label>
								<input type="text" id="customerName" name="customerName" class="form-control" placeholder="orderName" value="홍길동">
							</td>
						</tr>
						<tr name="pay_bill" style="display:none;">
							<td>구매자식별번호</td>
							<td data-toggle="tooltip">
								<label for="partnercd" class="sr-only"></label>
								<input type="text" id="customerKey" name="customerKey" class="form-control" placeholder="orderName" value="dongyubi">
							</td>
						</tr>
						<tr name="pay_card">
							<td>successUrl</td>
							<td data-toggle="tooltip">
								<label for="partnernm" class="sr-only"></label>
								<input type="text" id="successUrl" name="successUrl" class="form-control" placeholder="successUrl" value="http://15.164.244.37:8080/Home/pc/tosspayments/success.jsp">
							</td>
						</tr>
						<tr name="pay_card">
							<td>virtualAccountCallbackUrl</td>
							<td data-toggle="tooltip">
								<label for="partnernm" class="sr-only"></label>
								<input type="text" id="virtualAccountCallbackUrl" name="virtualAccountCallbackUrl" class="form-control" placeholder="virtualAccountCallbackUrl" value="http://15.164.244.37:8080/Home/pc/cas_noteurl.jsp">
							</td>
						</tr>
						<tr name="pay_bill" style="display:none;">
							<td>billingUrl</td>
							<td data-toggle="tooltip">
								<label for="version" class="sr-only"></label>
								<input type="text" id="billingUrl" name="billingUrl" class="form-control" placeholder="billingUrl" value="http://15.164.244.37:8080/Home/pc/tosspayments/billing.jsp">
							</td>
						</tr>
						<tr>
							<td>failUrl</td>
							<td data-toggle="tooltip">
								<label for="version" class="sr-only"></label>
								<input type="text" id="failUrl" name="failUrl" class="form-control" placeholder="failUrl" value="http://15.164.244.37:8080/Home/pc/tosspayments/fail.jsp">
							</td>
						</tr>
						<tr id="tr_callback">
							<td colspan="2">
								<input type="button" class="btn btn-default pull-right" id="submitBtn" name="submitBtn" value="결제요청" />
								<input type="button" class="btn btn-default pull-right" id="billingBtn" name="billingBtn" value="빌링결제" style="display:none;" />
							</td>
						</tr>
					</tbody>
				</table>
				</div>
			</form>
			<div class="container">
				<table class="table-sm table-bordered table-hover" style="width:100%;">
				<colgroup>
					<col width="30%">
					<col width="80%">
				</colgroup>
				<thead>
				</thead>
				<tbody>
					<tr>
						<td>결과</td>
						<td><textarea name="result" id="result" style="width:100%;border:1;overflow:visible;text-overflow:ellipsis;" rows=5></textarea></td>
					</tr>
				</tbody>
				</table>
			</div>
					
						
		</div>
	</div>
</div>
</body>
</html>